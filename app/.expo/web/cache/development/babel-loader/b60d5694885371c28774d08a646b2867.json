{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"E:\\\\3TI\\\\Integration\\\\projet-Integration\\\\app\\\\Profil\\\\Profil.js\";\nimport React, { useEffect, useState } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport * as ImagePicker from 'expo-image-picker';\nimport * as firebase from 'firebase';\nexport default function Profil() {\n  var _useState = useState(' '),\n      _useState2 = _slicedToArray(_useState, 2),\n      nom = _useState2[0],\n      setNom = _useState2[1];\n\n  var _useState3 = useState(' '),\n      _useState4 = _slicedToArray(_useState3, 2),\n      prenom = _useState4[0],\n      setPrenom = _useState4[1];\n\n  var _useState5 = useState(' '),\n      _useState6 = _slicedToArray(_useState5, 2),\n      adresse = _useState6[0],\n      setAdresse = _useState6[1];\n\n  var _useState7 = useState(' '),\n      _useState8 = _slicedToArray(_useState7, 2),\n      code = _useState8[0],\n      setCode = _useState8[1];\n\n  var _useState9 = useState(0),\n      _useState10 = _slicedToArray(_useState9, 2),\n      userId = _useState10[0],\n      setId = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      bool = _useState12[0],\n      setBool = _useState12[1];\n\n  var _useState13 = useState(true),\n      _useState14 = _slicedToArray(_useState13, 2),\n      btnDisplay = _useState14[0],\n      setBtn = _useState14[1];\n\n  var _useState15 = useState(null),\n      _useState16 = _slicedToArray(_useState15, 2),\n      image = _useState16[0],\n      setImage = _useState16[1];\n\n  var _useState17 = useState(false),\n      _useState18 = _slicedToArray(_useState17, 2),\n      isPicked = _useState18[0],\n      setIsPicked = _useState18[1];\n\n  var firebaseConfig = {\n    apiKey: \"AIzaSyBDfJQ6qgI8P9SR8-mQ6EK-2Ht11xjVDlY\",\n    authDomain: \"helper1348.firebaseapp.com\",\n    databaseURL: \"https://helper1348.firebaseio.com\",\n    projectId: \"helper1348\",\n    storageBucket: \"helper1348.appspot.com\",\n    messagingSenderId: \"295532527033\",\n    appId: \"1:295532527033:web:9b52add0968820d4244a68\",\n    measurementId: \"G-P3RX0697EB\"\n  };\n  useEffect(function () {\n    fetch('http://localhost:3000/users/2').then(function (response) {\n      return response.json();\n    }).then(function (json) {\n      console.log(json[0]);\n      setId(json[0].Id);\n      setNom(json[0].Nom);\n      setPrenom(json[0].Prenom);\n      setAdresse(json[0].Adresse);\n      setCode(json[0].CodePostal);\n      setImage(json[0].PhotoProfil);\n    }).catch(function (error) {\n      console.error(error);\n    });\n  }, []);\n\n  var handleChangeName = function handleChangeName(event) {\n    setNom(event.target.value);\n  };\n\n  var handleChangeSurname = function handleChangeSurname(event) {\n    setPrenom(event.target.value);\n  };\n\n  var handleChangeAddress = function handleChangeAddress(event) {\n    setAdresse(event.target.value);\n  };\n\n  var handleChangePostal = function handleChangePostal(event) {\n    setCode(event.target.value);\n  };\n\n  var pickImage = function pickImage() {\n    var _await$ImagePicker$re, status, result;\n\n    return _regeneratorRuntime.async(function pickImage$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!(Platform.OS !== 'web')) {\n              _context.next = 6;\n              break;\n            }\n\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(ImagePicker.requestCameraRollPermissionsAsync());\n\n          case 3:\n            _await$ImagePicker$re = _context.sent;\n            status = _await$ImagePicker$re.status;\n\n            if (status !== 'granted') {\n              alert('Sorry, we need camera roll permissions to make this work!');\n            }\n\n          case 6:\n            _context.next = 8;\n            return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n              mediaTypes: ImagePicker.MediaTypeOptions.All,\n              allowsEditing: true,\n              aspect: [4, 3],\n              quality: 1\n            }));\n\n          case 8:\n            result = _context.sent;\n            console.log(result);\n\n            if (!result.cancelled) {\n              setImage(result.uri);\n              setIsPicked(true);\n            }\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var uploadImage = function uploadImage(uri, imgName) {\n    var response, blob, ref, test;\n    return _regeneratorRuntime.async(function uploadImage$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(fetch(uri));\n\n          case 2:\n            response = _context2.sent;\n            _context2.next = 5;\n            return _regeneratorRuntime.awrap(response.blob());\n\n          case 5:\n            blob = _context2.sent;\n            ref = firebase.storage().ref().child(imgName);\n            ref.put(blob);\n            _context2.next = 10;\n            return _regeneratorRuntime.awrap(firebase.storage().ref(\"/\" + imgName).getDownloadURL());\n\n          case 10:\n            test = _context2.sent;\n            return _context2.abrupt(\"return\", test);\n\n          case 12:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var handleSubmit = function handleSubmit() {\n    var imageName, test1, requestOptions;\n    return _regeneratorRuntime.async(function handleSubmit$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            imageName = \"profile\" + userId;\n\n            if (!isPicked) {\n              _context3.next = 7;\n              break;\n            }\n\n            _context3.next = 4;\n            return _regeneratorRuntime.awrap(uploadImage(image, imageName));\n\n          case 4:\n            _context3.t0 = _context3.sent;\n            _context3.next = 8;\n            break;\n\n          case 7:\n            _context3.t0 = image;\n\n          case 8:\n            test1 = _context3.t0;\n            requestOptions = {\n              method: 'PUT',\n              headers: {\n                'Content-type': 'application/json; charset=UTF-8',\n                'Access-Control-Allow-Origin': '*'\n              },\n              body: JSON.stringify({\n                Nom: nom,\n                Prenom: prenom,\n                CodePostal: code,\n                Adresse: adresse,\n                userId: userId,\n                Photo: test1\n              })\n            };\n            console.log(requestOptions.body);\n            fetch(\"http://localhost:3000/updateData\", requestOptions).then(function () {\n              return \"Data successfully updated\";\n            }).catch(function (error) {\n              console.log(error);\n            });\n            setBtn(true);\n            setBool(false);\n\n          case 14:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var handleBoutonDisplay = function handleBoutonDisplay() {\n    setBtn(false);\n    setBool(true);\n  };\n\n  var handleCancel = function handleCancel() {\n    fetch('http://localhost:3000/users/2').then(function (response) {\n      return response.json();\n    }).then(function (json) {\n      console.log(json[0]);\n      setId(json[0].Id);\n      setNom(json[0].Nom);\n      setPrenom(json[0].Prenom);\n      setAdresse(json[0].Adresse);\n      setCode(json[0].CodePostal);\n      setImage(json[0].PhotoProfil);\n    }).catch(function (error) {\n      console.error(error);\n    });\n    setBtn(true);\n    setBool(false);\n  };\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    style: styles.top,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }\n  }, React.createElement(Image, {\n    source: {\n      uri: image || 'http://ssl.gstatic.com/accounts/ui/avatar_2x.png'\n    },\n    style: {\n      width: 75,\n      height: 75,\n      borderRadius: 200 / 2\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 9\n    }\n  }), bool && React.createElement(TouchableOpacity, {\n    onPress: pickImage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: {\n      color: 'red',\n      textDecorationLine: 'underline'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 13\n    }\n  }, \"Changer de photo de profil\"))), React.createElement(View, {\n    style: styles.inputContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 7\n    }\n  }, React.createElement(TextInput, {\n    style: styles.textInput,\n    value: nom,\n    name: \"Nom\",\n    editable: bool,\n    onChange: handleChangeName,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 9\n    }\n  }), React.createElement(TextInput, {\n    style: styles.textInput,\n    value: prenom,\n    editable: bool,\n    name: \"Prenom\",\n    onChange: handleChangeSurname,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 9\n    }\n  }), React.createElement(TextInput, {\n    style: styles.textInput,\n    value: adresse,\n    editable: bool,\n    name: \"adresse\",\n    onChange: handleChangeAddress,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 9\n    }\n  }), React.createElement(TextInput, {\n    style: styles.textInput,\n    value: code,\n    editable: bool,\n    name: \"code\",\n    onChange: handleChangePostal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 9\n    }\n  })), React.createElement(View, {\n    style: styles.bottom,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 7\n    }\n  }, btnDisplay && React.createElement(Button, {\n    title: \"Modifier\",\n    onPress: handleBoutonDisplay,\n    color: \"blue\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 13\n    }\n  }), !btnDisplay && React.createElement(View, {\n    style: {\n      flex: 2,\n      padding: '10'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 13\n    }\n  }, React.createElement(Button, {\n    title: \"Enregistrer\",\n    onPress: handleSubmit,\n    color: \"green\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 15\n    }\n  })), React.createElement(View, {\n    style: {\n      flex: 0.1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 9\n    }\n  }), !btnDisplay && React.createElement(View, {\n    style: {\n      flex: 2,\n      padding: '10'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 13\n    }\n  }, React.createElement(Button, {\n    title: \"Annuler\",\n    onPress: handleCancel,\n    color: \"red\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 15\n    }\n  }))));\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: \"space-between\",\n    alignItems: 'center',\n    backgroundColor: \"#fff\",\n    padding: 20\n  },\n  top: {\n    flex: 0.3,\n    borderTopLeftRadius: 20,\n    borderTopRightRadius: 20,\n    alignItems: 'center'\n  },\n  inputContainer: {\n    flex: 0.3\n  },\n  textInput: {\n    padding: 10,\n    textAlign: 'center',\n    fontWeight: 'bold',\n    borderWidth: 1,\n    borderColor: 'black',\n    marginBottom: 10\n  },\n  bottom: {\n    flex: 0.3,\n    flexDirection: \"column\",\n    justifyContent: \"space-between\"\n  },\n  separator: {\n    marginVertical: 8,\n    borderBottomColor: '#737373',\n    borderBottomWidth: StyleSheet.hairlineWidth\n  }\n});","map":{"version":3,"sources":["E:/3TI/Integration/projet-Integration/app/Profil/Profil.js"],"names":["React","useEffect","useState","ImagePicker","firebase","Profil","nom","setNom","prenom","setPrenom","adresse","setAdresse","code","setCode","userId","setId","bool","setBool","btnDisplay","setBtn","image","setImage","isPicked","setIsPicked","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","fetch","then","response","json","console","log","Id","Nom","Prenom","Adresse","CodePostal","PhotoProfil","catch","error","handleChangeName","event","target","value","handleChangeSurname","handleChangeAddress","handleChangePostal","pickImage","Platform","OS","requestCameraRollPermissionsAsync","status","alert","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","All","allowsEditing","aspect","quality","result","cancelled","uri","uploadImage","imgName","blob","ref","storage","child","put","getDownloadURL","test","handleSubmit","imageName","test1","requestOptions","method","headers","body","JSON","stringify","Photo","handleBoutonDisplay","handleCancel","styles","container","top","width","height","borderRadius","color","textDecorationLine","inputContainer","textInput","bottom","flex","padding","StyleSheet","create","justifyContent","alignItems","backgroundColor","borderTopLeftRadius","borderTopRightRadius","textAlign","fontWeight","borderWidth","borderColor","marginBottom","flexDirection","separator","marginVertical","borderBottomColor","borderBottomWidth","hairlineWidth"],"mappings":"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","sourcesContent":["/* eslint-disable no-alert */\r\n/* eslint-disable jsx-quotes */\r\n/* eslint-disable no-use-before-define */\r\n/* eslint-disable max-len */\r\n/* eslint-disable quotes */\r\nimport React, { useEffect, useState } from 'react';\r\nimport {\r\n  StyleSheet,\r\n  Button,\r\n  View,\r\n  Text,\r\n  TextInput,\r\n  Image,\r\n  TouchableOpacity,\r\n  Platform,\r\n} from \"react-native\";\r\nimport * as ImagePicker from 'expo-image-picker';\r\nimport * as firebase from 'firebase';\r\n//import App from './firebase'\r\n\r\n// eslint-disable-next-line require-jsdoc\r\nexport default function Profil() {\r\n  const [nom, setNom] = useState(' ');\r\n  const [prenom, setPrenom] = useState(' ');\r\n  const [adresse, setAdresse] = useState(' ');\r\n  const [code, setCode] = useState(' ');\r\n  const [userId, setId] = useState(0);\r\n  const [bool, setBool] = useState(false);\r\n  const [btnDisplay, setBtn] = useState(true);\r\n  const [image, setImage] = useState(null);\r\n  const [isPicked, setIsPicked] = useState(false);\r\n\r\n const firebaseConfig = {\r\n    apiKey: \"AIzaSyBDfJQ6qgI8P9SR8-mQ6EK-2Ht11xjVDlY\",\r\n    authDomain: \"helper1348.firebaseapp.com\",\r\n    databaseURL: \"https://helper1348.firebaseio.com\",\r\n    projectId: \"helper1348\",\r\n    storageBucket: \"helper1348.appspot.com\",\r\n    messagingSenderId: \"295532527033\",\r\n    appId: \"1:295532527033:web:9b52add0968820d4244a68\",\r\n    measurementId: \"G-P3RX0697EB\"\r\n  };\r\n\r\n // firebase.initializeApp(firebaseConfig);\r\n // firebase.analytics();\r\n\r\n\r\n  useEffect(() => {\r\n    fetch('http://localhost:3000/users/2')\r\n      .then((response) => response.json())\r\n      .then((json) => {\r\n        console.log(json[0]);\r\n        setId(json[0].Id);\r\n        setNom(json[0].Nom);\r\n        setPrenom(json[0].Prenom);\r\n        setAdresse(json[0].Adresse);\r\n        setCode(json[0].CodePostal);\r\n        setImage(json[0].PhotoProfil);\r\n      })\r\n      .catch((error) => {\r\n        console.error(error);\r\n      });\r\n\r\n  \r\n  }, []);\r\n\r\n  const handleChangeName = (event) => {\r\n    setNom(event.target.value);\r\n  };\r\n  const handleChangeSurname = (event) => {\r\n    setPrenom(event.target.value);\r\n  };\r\n  const handleChangeAddress = (event) => {\r\n    setAdresse(event.target.value);\r\n  };\r\n  const handleChangePostal = (event) => {\r\n    setCode(event.target.value);\r\n  };\r\n\r\n  const pickImage = async () => {\r\n    if (Platform.OS !== 'web') {\r\n      const { status } = await ImagePicker.requestCameraRollPermissionsAsync();\r\n      if (status !== 'granted') {\r\n        alert('Sorry, we need camera roll permissions to make this work!');\r\n      }\r\n    }\r\n\r\n    const result = await ImagePicker.launchImageLibraryAsync({\r\n      mediaTypes: ImagePicker.MediaTypeOptions.All,\r\n      allowsEditing: true,\r\n      aspect: [4, 3],\r\n      quality: 1,\r\n    });\r\n\r\n    console.log(result);\r\n    if (!result.cancelled) {\r\n      setImage(result.uri);\r\n      setIsPicked(true);\r\n    }\r\n  };\r\n\r\n  const uploadImage = async (uri, imgName) => {\r\n    const response = await fetch(uri);\r\n    const blob = await response.blob();\r\n\r\n    const ref = firebase.storage().ref().child(imgName);\r\n    ref.put(blob);\r\n\r\n    const test = await firebase.storage()\r\n      .ref(`/${imgName}`)\r\n      .getDownloadURL();\r\n\r\n    return test;\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    const imageName = `profile${userId}`;\r\n\r\n    const test1 = isPicked ? await uploadImage(image, imageName) : image;\r\n\r\n    const requestOptions = {\r\n      method: 'PUT',\r\n      headers:\r\n      {\r\n        'Content-type': 'application/json; charset=UTF-8',\r\n        'Access-Control-Allow-Origin': '*',\r\n      },\r\n      body: JSON.stringify({\r\n        Nom: nom,\r\n        Prenom: prenom,\r\n        CodePostal: code,\r\n        Adresse: adresse,\r\n        userId,\r\n        Photo: test1,\r\n      }),\r\n    };\r\n    console.log(requestOptions.body);\r\n\r\n    fetch(\"http://localhost:3000/updateData\", requestOptions)\r\n      .then(() => (\"Data successfully updated\"))\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n\r\n    setBtn(true);\r\n    setBool(false);\r\n  };\r\n\r\n  const handleBoutonDisplay = () => {\r\n    setBtn(false);\r\n    setBool(true);\r\n  };\r\n  const handleCancel = () => {\r\n    fetch('http://localhost:3000/users/2')\r\n      .then((response) => response.json())\r\n      .then((json) => {\r\n        console.log(json[0]);\r\n        setId(json[0].Id);\r\n        setNom(json[0].Nom);\r\n        setPrenom(json[0].Prenom);\r\n        setAdresse(json[0].Adresse);\r\n        setCode(json[0].CodePostal);\r\n        setImage(json[0].PhotoProfil);\r\n      })\r\n      .catch((error) => {\r\n        console.error(error);\r\n      });\r\n    setBtn(true);\r\n    setBool(false);\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={styles.top}>\r\n        <Image\r\n          source={{ uri: image || 'http://ssl.gstatic.com/accounts/ui/avatar_2x.png' }}\r\n          style={{\r\n            width: 75,\r\n            height: 75,\r\n            borderRadius: 200 / 2,\r\n          }}\r\n        />\r\n        {bool && (\r\n          <TouchableOpacity onPress={pickImage}>\r\n            <Text style={{\r\n              color: 'red',\r\n              textDecorationLine: 'underline',\r\n            }}\r\n            >\r\n              Changer de photo de profil\r\n            </Text>\r\n          </TouchableOpacity>\r\n        )}\r\n      </View>\r\n\r\n      <View style={styles.inputContainer}>\r\n        <TextInput\r\n          style={styles.textInput}\r\n          value={nom}\r\n          name=\"Nom\"\r\n          editable={bool}\r\n          onChange={handleChangeName}\r\n        />\r\n        <TextInput\r\n          style={styles.textInput}\r\n          value={prenom}\r\n          editable={bool}\r\n          name=\"Prenom\"\r\n          onChange={handleChangeSurname}\r\n        />\r\n        <TextInput\r\n          style={styles.textInput}\r\n          value={adresse}\r\n          editable={bool}\r\n          name=\"adresse\"\r\n          onChange={handleChangeAddress}\r\n\r\n        />\r\n        <TextInput\r\n          style={styles.textInput}\r\n          value={code}\r\n          editable={bool}\r\n          name=\"code\"\r\n          onChange={handleChangePostal}\r\n        />\r\n      </View>\r\n      <View style={styles.bottom}>\r\n        {\r\n          btnDisplay\r\n          && (\r\n            <Button\r\n              title=\"Modifier\"\r\n              onPress={handleBoutonDisplay}\r\n              color='blue'\r\n            />\r\n          )\r\n        }\r\n        {\r\n          !btnDisplay\r\n          && (\r\n            <View style={{ flex: 2, padding: '10' }}>\r\n              <Button\r\n                title=\"Enregistrer\"\r\n                onPress={handleSubmit}\r\n                color='green'\r\n              />\r\n            </View>\r\n          )\r\n        }\r\n        <View style={{ flex: 0.1 }} />\r\n        {\r\n          !btnDisplay && (\r\n            <View style={{ flex: 2, padding: '10' }}>\r\n              <Button\r\n                title=\"Annuler\"\r\n                onPress={handleCancel}\r\n                color=\"red\"\r\n              />\r\n            </View>\r\n          )\r\n        }\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    justifyContent: \"space-between\",\r\n    alignItems: 'center',\r\n    backgroundColor: \"#fff\",\r\n    padding: 20,\r\n  },\r\n  top: {\r\n    flex: 0.3,\r\n    borderTopLeftRadius: 20,\r\n    borderTopRightRadius: 20,\r\n    alignItems: 'center',\r\n  },\r\n  inputContainer: {\r\n    flex: 0.3,\r\n  },\r\n  textInput: {\r\n    padding: 10,\r\n    textAlign: 'center',\r\n    fontWeight: 'bold',\r\n    borderWidth: 1,\r\n    borderColor: 'black',\r\n    marginBottom: 10,\r\n  },\r\n  bottom: {\r\n    flex: 0.3,\r\n    flexDirection: \"column\",\r\n    justifyContent: \"space-between\",\r\n  },\r\n  separator: {\r\n    marginVertical: 8,\r\n    borderBottomColor: '#737373',\r\n    borderBottomWidth: StyleSheet.hairlineWidth,\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}